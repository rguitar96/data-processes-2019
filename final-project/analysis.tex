\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\author{}
\date{\vspace{-2.5em}}

\begin{document}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\KeywordTok{library}\NormalTok{(patchwork)}
\KeywordTok{library}\NormalTok{(treemapify)}
\KeywordTok{library}\NormalTok{(reshape2)}
\KeywordTok{library}\NormalTok{(plyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -------------------------------------------------------------------------
\end{verbatim}

\begin{verbatim}
## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)
\end{verbatim}

\begin{verbatim}
## -------------------------------------------------------------------------
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'plyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:dplyr':
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------------------------------------------------------------------------------------------------------------- tidyverse 1.2.1 --
\end{verbatim}

\begin{verbatim}
## v tibble  2.1.3     v purrr   0.3.3
## v tidyr   1.0.0     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------------------------------------------------------------------------------------------------------------ tidyverse_conflicts() --
## x plyr::arrange()   masks dplyr::arrange()
## x purrr::compact()  masks plyr::compact()
## x plyr::count()     masks dplyr::count()
## x plyr::failwith()  masks dplyr::failwith()
## x dplyr::filter()   masks stats::filter()
## x plyr::id()        masks dplyr::id()
## x dplyr::lag()      masks stats::lag()
## x plyr::mutate()    masks dplyr::mutate()
## x plyr::rename()    masks dplyr::rename()
## x plyr::summarise() masks dplyr::summarise()
## x plyr::summarize() masks dplyr::summarize()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{usa_deaths_states =}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"data/death-causes-usa.csv"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{";"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(Cause.Name }\OperatorTok{!=}\StringTok{ "All causes"}\NormalTok{)}
\NormalTok{spain_deaths =}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"data/death-causes-spain-2017-modified.csv"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{";"}\NormalTok{,}\DataTypeTok{fileEncoding=}\StringTok{"UTF-8-BOM"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

USA dataset

The data published by the Centers for Disease Control and Prevention was
gathered by the National Center for Health Statistics (NCHS), with the
last revision being made in 2017. This dataset contains the infromation
of the 10 leading causes of death in the United States. The data is
based on information from resident death certificates filed in the 50
states and the District of Columbia using demographic and medical
characteristics. The features are:

\begin{itemize}
\tightlist
\item
  \textbf{Year}: The year the sample was taken
\item
  \textbf{X113.Cause.Name}: Official labled causes of death
\item
  \textbf{Cause.Name}: Simplified cause of daeth name
\item
  \textbf{State}: Name of the state the sample was taken
\item
  \textbf{Deaths}: The number of deaths due to the cause in the state in
  the given year
\end{itemize}

Age-adjusted death rates (per 100,000 population) are based on the 2000
U.S. standard population.

The information we will use in this dataset leaves us with 10868
observations and 6 columns (Year, Technical Cause Name, Cause Name,
State, Deaths and Age-adjusted Death Rate).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{dim}\NormalTok{(usa_deaths_states)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9880    6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(usa_deaths_states)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Year                                      X113.Cause.Name
## 1 2017 Accidents (unintentional injuries) (V01-X59,Y85-Y86)
## 2 2017 Accidents (unintentional injuries) (V01-X59,Y85-Y86)
## 3 2017 Accidents (unintentional injuries) (V01-X59,Y85-Y86)
## 4 2017 Accidents (unintentional injuries) (V01-X59,Y85-Y86)
## 5 2017 Accidents (unintentional injuries) (V01-X59,Y85-Y86)
## 6 2017 Accidents (unintentional injuries) (V01-X59,Y85-Y86)
##               Cause.Name         State Deaths Age.adjusted.Death.Rate
## 1 Unintentional injuries United States 169936                    49.4
## 2 Unintentional injuries       Alabama   2703                    53.8
## 3 Unintentional injuries        Alaska    436                    63.7
## 4 Unintentional injuries       Arizona   4184                    56.2
## 5 Unintentional injuries      Arkansas   1625                    51.8
## 6 Unintentional injuries    California  13840                    33.2
\end{verbatim}

Spanish dataset

Spanish data was found through a goverment webpage (datos.gob.es), and
is part of a study done by the Spanish Institute of Statistics (INE),
for the year 2017. We adapted the death causes in Spanish dataset to
match the ones in the US one, as the Spanish dataset was more detailed
(more details in the file disease-comparison.xlsx). After doing this, we
see that the dataset has 1056 observations and 4 columns (Disease,
Gender, Age and Number of Deaths).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{dim}\NormalTok{(spain_deaths)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1056    4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{head}\NormalTok{(spain_deaths)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      DISEASE  GENDER      AGE NUMBER.OF.DEATHS
## 1 All causes    Both All ages           424523
## 2 All causes   Males All ages           214236
## 3 All causes Females All ages           210287
## 4 All causes    Both   0 to 1             1092
## 5 All causes   Males   0 to 1              619
## 6 All causes Females   0 to 1              473
\end{verbatim}

As we see, we have different data for both countries, so the comparison
will be tough. We will first filter for the country data, filtering
state data in the US dataset in order to view the country as a whole.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{usa_deaths =}\StringTok{ }\NormalTok{usa_deaths_states }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(State }\OperatorTok{==}\StringTok{ "United States"}\NormalTok{)}
\KeywordTok{head}\NormalTok{(usa_deaths)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Year                                      X113.Cause.Name
## 1 2017 Accidents (unintentional injuries) (V01-X59,Y85-Y86)
## 2 2017                            Alzheimer's disease (G30)
## 3 2017                   Cerebrovascular diseases (I60-I69)
## 4 2017         Chronic lower respiratory diseases (J40-J47)
## 5 2017                          Diabetes mellitus (E10-E14)
## 6 2017          Diseases of heart (I00-I09,I11,I13,I20-I51)
##               Cause.Name         State Deaths Age.adjusted.Death.Rate
## 1 Unintentional injuries United States 169936                    49.4
## 2    Alzheimer's disease United States 121404                    31.0
## 3                 Stroke United States 146383                    37.6
## 4                   CLRD United States 160201                    40.9
## 5               Diabetes United States  83564                    21.5
## 6          Heart disease United States 647457                   165.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(usa_deaths, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{Year, }\DataTypeTok{y=}\NormalTok{Age.adjusted.Death.Rate, }\DataTypeTok{fill=}\NormalTok{Cause.Name)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Trend of death causes"}\NormalTok{, }\DataTypeTok{x =} \StringTok{""}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Death Rate / 100.000 (Age Adjusted)"}\NormalTok{, }\DataTypeTok{fill =} \StringTok{"Causes"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_brewer}\NormalTok{(}\DataTypeTok{palette =} \StringTok{"Paired"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{0.5}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_minimal}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_area}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{analysis_files/figure-latex/unnamed-chunk-6-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(usa_deaths, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{Year, }\DataTypeTok{y=}\KeywordTok{log}\NormalTok{(Deaths), }\DataTypeTok{color=}\NormalTok{Cause.Name)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Changes on death causes over the years"}\NormalTok{, }\DataTypeTok{x =} \StringTok{""}\NormalTok{, }\DataTypeTok{y =} \StringTok{"log(Death Rate)"}\NormalTok{, }\DataTypeTok{fill =} \StringTok{"Causes"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_brewer}\NormalTok{(}\DataTypeTok{palette =} \StringTok{"Paired"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{0.5}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_minimal}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{() }
\end{Highlighting}
\end{Shaded}

\includegraphics{analysis_files/figure-latex/unnamed-chunk-6-2.pdf}

Two states with th greates difference

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{usa_deaths_CalWyom =}\StringTok{ }\NormalTok{usa_deaths_states }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(}\KeywordTok{str_detect}\NormalTok{(State, }\StringTok{'California|Wyoming'}\NormalTok{))}

\KeywordTok{ggplot}\NormalTok{(usa_deaths_CalWyom, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{Year, }\DataTypeTok{y=}\KeywordTok{log}\NormalTok{(Deaths), }\DataTypeTok{color=}\NormalTok{Cause.Name)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Changes on death causes over the years"}\NormalTok{, }\DataTypeTok{x =} \StringTok{""}\NormalTok{, }\DataTypeTok{y =} \StringTok{"log(Death Rate)"}\NormalTok{, }\DataTypeTok{fill =} \StringTok{"Causes"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_brewer}\NormalTok{(}\DataTypeTok{palette =} \StringTok{"Paired"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{0.5}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_minimal}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{facet_grid}\NormalTok{(}\OperatorTok{~}\NormalTok{State)}
\end{Highlighting}
\end{Shaded}

\includegraphics{analysis_files/figure-latex/unnamed-chunk-7-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Get data about the top 10 diseases in the Spanish data set. Ignore "Other causes"}
\NormalTok{topTenSpanishDiseases<-}\StringTok{ }\NormalTok{spain_deaths }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(GENDER }\OperatorTok{==}\StringTok{ "Both"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(AGE}\OperatorTok{==}\StringTok{"All ages"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(DISEASE}\OperatorTok{!=}\StringTok{"All causes"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(DISEASE}\OperatorTok{!=}\StringTok{"Other causes"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{top_n}\NormalTok{(}\DecValTok{10}\NormalTok{, NUMBER.OF.DEATHS)}

\CommentTok{#Generate tree map}
\KeywordTok{ggplot}\NormalTok{(topTenSpanishDiseases, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{area=}\NormalTok{NUMBER.OF.DEATHS, }\DataTypeTok{fill=}\NormalTok{DISEASE, }\DataTypeTok{label=}\NormalTok{NUMBER.OF.DEATHS)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_brewer}\NormalTok{(}\DataTypeTok{palette =} \StringTok{"Paired"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Most deadly diseases in Spain (2017)"}\NormalTok{, }\DataTypeTok{fill =} \StringTok{"Causes"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_treemap}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_treemap_text}\NormalTok{(}\DataTypeTok{fontface =} \StringTok{"italic"}\NormalTok{,}
                    \DataTypeTok{colour =} \StringTok{"white"}\NormalTok{,}
                    \DataTypeTok{place =} \StringTok{"centre"}\NormalTok{,}
                    \DataTypeTok{grow =} \OtherTok{FALSE}\NormalTok{,}
                    \DataTypeTok{reflow =} \OtherTok{TRUE}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics{analysis_files/figure-latex/unnamed-chunk-8-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Create data frame to hold data about people who have Diseases of the circulatory system}
\NormalTok{diseasesCircSystemData <-}\StringTok{ }\NormalTok{spain_deaths}

\CommentTok{#Set up AGE factor for pyramid plot}
\NormalTok{diseasesCircSystemData}\OperatorTok{$}\NormalTok{AGE <-}\StringTok{ }\KeywordTok{factor}\NormalTok{(diseasesCircSystemData}\OperatorTok{$}\NormalTok{AGE, }\KeywordTok{c}\NormalTok{(}\StringTok{"0 to 1"}\NormalTok{, }\StringTok{"1 to 4"}\NormalTok{, }\StringTok{"5 to 9"}\NormalTok{, }\StringTok{"10 to 14"}\NormalTok{, }\StringTok{"15 to 19"}\NormalTok{, }\StringTok{"20 to 24"}\NormalTok{, }\StringTok{"25 to 29"}\NormalTok{, }\StringTok{"30 to 34"}\NormalTok{, }\StringTok{"35 to 39"}\NormalTok{, }\StringTok{"40 to 44"}\NormalTok{, }\StringTok{"45 to 49"}\NormalTok{, }\StringTok{"50 to 54"}\NormalTok{, }\StringTok{"55 to 59"}\NormalTok{, }\StringTok{"60 to 64"}\NormalTok{, }\StringTok{"65 to 69"}\NormalTok{, }\StringTok{"70 to 74"}\NormalTok{, }\StringTok{"75 to 79"}\NormalTok{, }\StringTok{"80 to 84"}\NormalTok{, }\StringTok{"85 to 89"}\NormalTok{, }\StringTok{"90 to 94"}\NormalTok{, }\StringTok{"95 or more"}\NormalTok{, }\StringTok{"All ages"}\NormalTok{))}

\CommentTok{#Filter data to create table about only circular system disease }
\NormalTok{diseasesCircSystemData <-}\StringTok{ }\NormalTok{diseasesCircSystemData }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(DISEASE }\OperatorTok{==}\StringTok{ "Diseases of the circulatory system"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(GENDER }\OperatorTok{!=}\StringTok{ "Both"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(AGE }\OperatorTok{!=}\StringTok{ "All ages"}\NormalTok{) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{modify_at}\NormalTok{(}\StringTok{"DISEASE"}\NormalTok{,}\OperatorTok{~}\OtherTok{NULL}\NormalTok{)}

\KeywordTok{summary}\NormalTok{(diseasesCircSystemData)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      GENDER         AGE     NUMBER.OF.DEATHS 
##  Both   : 0   0 to 1  : 2   Min.   :    0.0  
##  Females:21   1 to 4  : 2   1st Qu.:   14.5  
##  Males  :21   5 to 9  : 2   Median :  348.5  
##               10 to 14: 2   Mean   : 2274.5  
##               15 to 19: 2   3rd Qu.: 2880.8  
##               20 to 24: 2   Max.   :13648.0  
##               (Other) :30
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Mutate Male data so it will be negative on bargraph}
\NormalTok{diseasesCircSystemData <-}\StringTok{ }\NormalTok{diseasesCircSystemData }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{NUMBER.OF.DEATHS =} \KeywordTok{ifelse}\NormalTok{(GENDER }\OperatorTok{==}\StringTok{ "Males"}\NormalTok{, }\DecValTok{-1} \OperatorTok{*}\StringTok{ }\NormalTok{NUMBER.OF.DEATHS, NUMBER.OF.DEATHS))}

\CommentTok{#Generate pyramid plot}
 \KeywordTok{ggplot}\NormalTok{(diseasesCircSystemData, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE, }\DataTypeTok{y =}\NormalTok{ NUMBER.OF.DEATHS, }\DataTypeTok{fill =}\NormalTok{ GENDER)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{data=}\NormalTok{diseasesCircSystemData[diseasesCircSystemData}\OperatorTok{$}\NormalTok{GENDER }\OperatorTok{==}\StringTok{ "Females"}\NormalTok{,], }\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{data=}\NormalTok{diseasesCircSystemData[diseasesCircSystemData}\OperatorTok{$}\NormalTok{GENDER }\OperatorTok{==}\StringTok{ "Males"}\NormalTok{,], }\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{breaks =} \KeywordTok{seq}\NormalTok{(}\OperatorTok{-}\DecValTok{15000}\NormalTok{, }\DecValTok{15000}\NormalTok{, }\DecValTok{5000}\NormalTok{), }
                     \DataTypeTok{labels =} \KeywordTok{paste0}\NormalTok{(}\KeywordTok{as.character}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\KeywordTok{seq}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{-5}\NormalTok{), }\KeywordTok{seq}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{5}\NormalTok{))), }\StringTok{""}\NormalTok{)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{(}\DataTypeTok{ylim=}\KeywordTok{c}\NormalTok{(}\OperatorTok{-}\DecValTok{15000}\NormalTok{,}\DecValTok{15000}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{scale_fill_brewer}\NormalTok{(}\DataTypeTok{palette =} \StringTok{"Set1"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Number of people who die from Diseases of the circulatory system"}\NormalTok{, }\DataTypeTok{y =} \StringTok{"Number of deaths (1,000)"}\NormalTok{, }\DataTypeTok{x =} \StringTok{"Age"}\NormalTok{, }\DataTypeTok{fill =} \StringTok{"Gender"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{analysis_files/figure-latex/unnamed-chunk-10-1.pdf}

\end{document}
